nameOverride: "logging"
fullnameOverride: "fluent-bit"

image:
  repository: europe-docker.pkg.dev/gardener-project/snapshots/gardener
  tag: "latest"
  pullPolicy: IfNotPresent
  imagePullSecrets: []

fluentBit:
  image: ghcr.io/fluent/fluent-operator/fluent-bit:v4.2.0

  livenessProbe:
    failureThreshold: 5
    httpGet:
      path: /healthz
      port: metrics-plugin
      scheme: HTTP
    initialDelaySeconds: 30
    periodSeconds: 30
    successThreshold: 1
    timeoutSeconds: 10

  readinessProbe: {}

  resources:
    limits:
      memory: 350Mi
    requests:
      memory: 200Mi

  ports:
    - name: metrics
      containerPort: 2020
      protocol: TCP
    - name: metrics-plugin
      containerPort: 2021
      protocol: TCP

  tolerations:
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
    - effect: NoSchedule
      key: node-role.kubernetes.io/control-plane

  nodeSelector: {} # node selector for DaemonSet
  affinity: {} # node affinity for DaemonSet

  volumeMounts:
    - name: buffer
      mountPath: /fluentbit/buffers
  volumes:
    - name: buffer
      emptyDir:
        sizeLimit: 10Mi

  service:
    type: ClusterIP
    ports: # default ports for fluent-bit service
      - port: 2020
        targetPort: metrics
        protocol: TCP
        name: metrics
      - port: 2021
        targetPort: metrics-plugin
        protocol: TCP
        name: metrics-plugin

plutono:
  image: ghcr.io/credativ/plutono:v7.5.42
  ports:
    - name: web
      containerPort: 3000
      protocol: TCP
  resources:
    requests:
      cpu: 5m
      memory: 64Mi
  securityContext:
    allowPrivilegeEscalation: false

  nodeSelector: {} # node selector for Deployment
  affinity: {} # node affinity for Deployment
  tolerations: []
  volumeMounts: [] # additional volume mounts to add to the Deployment
  volumes: [] # additional volumes to add to the Deployment

prometheus:
  image: prom/prometheus:main

  livenessProbe:
    failureThreshold: 6
    httpGet:
      path: /-/healthy
      port: web
      scheme: HTTP
    periodSeconds: 5
    successThreshold: 1
    timeoutSeconds: 3

  readinessProbe:
    failureThreshold: 3
    httpGet:
      path: /-/ready
      port: web
      scheme: HTTP
    periodSeconds: 5
    successThreshold: 1
    timeoutSeconds: 3

  startupProbe:
    failureThreshold: 60
    httpGet:
      path: /-/ready
      port: web
      scheme: HTTP
    periodSeconds: 15
    successThreshold: 1
    timeoutSeconds: 3

  resources:
    requests:
      cpu: 300m
      memory: 1000Mi

  ports:
    - name: web
      containerPort: 9090
      protocol: TCP

  podSecurityContext:
    runAsUser: 0

  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true

  nodeSelector: {} # node selector for StatefulSet
  affinity: {} # node affinity for StatefulSet
  tolerations: []
  volumeMounts: [] # additional volume mounts to add to the StatefulSet
  volumes: [] # additional volumes to add to the StatefulSet

victorialogs:
  image: victoriametrics/victoria-logs:v1.39.0
  livenessProbe:
    failureThreshold: 10
    initialDelaySeconds: 30
    periodSeconds: 30
    successThreshold: 1
    tcpSocket:
      port: http
    timeoutSeconds: 5

  readinessProbe:
    failureThreshold: 3
    httpGet:
      path: /health
      port: http
      scheme: HTTP
    initialDelaySeconds: 5
    periodSeconds: 5
    successThreshold: 1
    timeoutSeconds: 5

  podSecurityContext:
    fsGroup: 2000
    runAsNonRoot: true
    runAsUser: 1000

  resources:
    requests:
      cpu: 250m
      memory: 64Mi

  ports:
    - containerPort: 9428
      name: http
      protocol: TCP

  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true

  nodeSelector: {} # node selector for StatefulSet
  affinity: {} # node affinity for StatefulSet
  tolerations: []
  volumeMounts: [] # additional volume mounts to add to the StatefulSet
  volumes: [] # additional volumes to add to the StatefulSet

otelCollector:
  image: otel/opentelemetry-collector-contrib:0.141.0
  replicas: 1

  livenessProbe:
    httpGet:
      path: /
      port: 13133
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /
      port: 13133
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  podSecurityContext:
    fsGroup: 10001
    runAsNonRoot: true
    runAsUser: 10001

  resources:
    requests:
      memory: 256Mi
    limits:
      memory: 1Gi

  ports:
    - name: otlp-grpc
      containerPort: 4317
      protocol: TCP
    - name: otlp-http
      containerPort: 4318
      protocol: TCP
    - name: metrics
      containerPort: 8888
      protocol: TCP
    - name: health
      containerPort: 13133
      protocol: TCP

  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true

  nodeSelector: {} # node selector for Deployment
  affinity: {} # node affinity for Deployment
  tolerations: []
  volumeMounts: [] # additional volume mounts to add to the Deployment
  volumes: [] # additional volumes to add to the Deployment
